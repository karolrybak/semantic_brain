{
  "version": "0.0.202",
  "files": [
    {
      "filename": "src/App.vue",
      "content": "<template>\n  <div class=\"relative w-full h-screen bg-[#19191d] overflow-hidden\">\n    <div class=\"absolute inset-0 z-0\">\n        <ConceptGraph \n          ref=\"codeGraphRef\"\n          :nodes=\"store.nodesArray\" \n          :links=\"store.linksArray\"\n          :settings=\"store.state.settings\"\n          :selected-node-id=\"selectedNodeId\"\n          :thinking-node-id=\"store.state.thinkingNodeId\"\n          @select=\"onNodeSelect\" \n        />\n    </div>\n\n    <div v-if=\"store.isStateLoaded && store.nodesArray.length > 0\" class=\"absolute top-4 left-4 bottom-4 z-20 pointer-events-none flex flex-col gap-2 w-80\">\n       <div class=\"pointer-events-auto flex-1 overflow-hidden flex flex-col\">\n         <GraphExplorer \n            :selected-node=\"selectedNode\" \n            @select=\"onNodeSelect\" \n         />\n       </div>\n\n       <div class=\"pointer-events-auto flex items-center gap-2\">\n         <button @click=\"promptNewIndependentNode\" class=\"w-10 h-10 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-lg flex items-center justify-center transition-transform hover:scale-110\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg></button>\n         <label class=\"flex items-center gap-2 bg-zinc-900/90 border border-zinc-800 rounded-full px-3 py-1.5 cursor-pointer shadow-lg hover:bg-zinc-800 transition-colors\">\n            <input type=\"checkbox\" :checked=\"store.state.settings.autoExplore\" @change=\"(e: any) => toggleAutoExplore(e.target.checked)\" class=\"w-4 h-4 accent-indigo-500\" />\n            <span class=\"text-[10px] font-bold text-zinc-400 uppercase tracking-tighter\">Auto-Explore</span>\n         </label>\n       </div>\n    </div>\n\n    <div v-if=\"store.isStateLoaded && store.nodesArray.length > 0\" class=\"absolute top-16 right-4 bottom-4 z-20 pointer-events-none flex flex-col gap-3 items-center overflow-y-auto overflow-x-visible custom-scrollbar px-3\">\n        <div \n          v-for=\"island in store.graphIslands\" \n          :key=\"island.id\" \n          @click=\"onNodeSelect(island)\"\n          class=\"pointer-events-auto w-20 h-24 flex-shrink-0 flex flex-col items-center justify-center rounded-xl border transition-all cursor-pointer bg-zinc-900/40 backdrop-blur-sm shadow-xl hover:scale-105 active:scale-95 group select-none\"\n          :class=\"selectedNodeId === island.id ? 'border-indigo-500 bg-indigo-950/20 shadow-indigo-500/10' : 'border-zinc-800/50 hover:border-zinc-600'\"\n        >\n           <NodeIcon type=\"cluster\" :color=\"selectedNodeId === island.id ? '#6366f1' : '#52525b'\" class=\"w-10 h-10 transition-colors\" />\n           <span class=\"mt-2 text-[9px] font-bold uppercase tracking-tighter text-center px-1 max-w-full truncate\" :class=\"selectedNodeId === island.id ? 'text-indigo-400' : 'text-zinc-500 group-hover:text-zinc-300'\">\n             {{ island.label }}\n           </span>\n        </div>\n    </div>\n\n    <div v-if=\"store.isStateLoaded && store.nodesArray.length > 0\" class=\"absolute top-6 left-1/2 -translate-x-1/2 z-30 pointer-events-none\">\n       <div class=\"pointer-events-auto\">\n         <AspectBar \n            :defined-aspects=\"store.state.settings.definedAspects\"\n            :active-aspects=\"store.state.settings.activeAspects\"\n         />\n       </div>\n    </div>\n\n    <div v-if=\"store.isStateLoaded && store.nodesArray.length > 0\" class=\"absolute top-4 right-4 z-30 flex gap-2\">\n      <button @click=\"codeGraphRef?.reheat()\" class=\"p-2 bg-zinc-900/80 border border-zinc-800 rounded-lg text-zinc-400 hover:text-white hover:bg-zinc-800 transition-colors\" title=\"Re-layout\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21.5 2v6h-6M2.5 22v-6h6M2 12c0-4.4 3.6-8 8-8 3.3 0 6.2 2 7.4 4.9M22 12c0 4.4-3.6 8-8 8-3.3 0-6.2-2-7.4-4.9\"/></svg></button>\n\n      <div class=\"relative\">\n        <button @click=\"showBrainPanel = !showBrainPanel\" class=\"p-2 bg-zinc-900/80 border border-zinc-800 rounded-lg transition-colors\" :class=\"store.aiStatus === 'ready' ? 'text-emerald-500' : (store.aiStatus === 'thinking' ? 'text-indigo-400 animate-pulse' : 'text-zinc-500')\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.78-3.06 2.5 2.5 0 0 1-2.41-4.23 2.5 2.5 0 0 1 .53-4.58A2.5 2.5 0 0 1 9.5 2z\"></path><path d=\"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.78-3.06 2.5 2.5 0 0 0 2.41-4.23 2.5 2.5 0 0 0-.53-4.58A2.5 2.5 0 0 0 14.5 2z\"></path></svg>\n        </button>\n        <div v-if=\"showBrainPanel\" class=\"absolute top-full right-0 mt-2\">\n          <BrainPanel \n            :status=\"store.aiStatus\" \n            :config=\"store.serverAiConfig\" \n            @load=\"store.send({ type: 'LOAD_AI_MODEL' })\"\n            @unload=\"store.send({ type: 'UNLOAD_AI_MODEL' })\"\n            @updateConfig=\"(c) => store.send({ type: 'UPDATE_AI_CONFIG', config: c })\"\n          />\n        </div>\n      </div>\n\n      <div class=\"relative\">\n        <button @click=\"showConfig = !showConfig\" class=\"p-2 bg-zinc-900/80 border border-zinc-800 rounded-lg text-zinc-400 hover:text-white\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"></path><circle cx=\"12\" cy=\"12\" r=\"3\"></circle></svg></button>\n        <div v-if=\"showConfig\" class=\"absolute top-full right-0 mt-2\"><ConfigPanel /></div>\n      </div>\n    </div>\n\n    <div v-if=\"store.isConnected && store.isStateLoaded && store.nodesArray.length === 0\" class=\"absolute inset-0 z-[100] bg-black/40 backdrop-blur-md flex items-center justify-center\">\n       <InitialOnboarding @start=\"handleOnboardingComplete\" />\n    </div>\n\n    <div v-if=\"!store.isConnected || !store.isStateLoaded\" class=\"absolute inset-0 z-[110] bg-black/60 backdrop-blur flex items-center justify-center\">\n      <div class=\"bg-zinc-900 border border-zinc-800 p-6 rounded-xl flex flex-col items-center gap-4\">\n        <div class=\"w-10 h-10 border-4 border-t-indigo-500 border-zinc-800 rounded-full animate-spin\"></div>\n        <p class=\"text-white font-bold tracking-tight\">{{ !store.isConnected ? 'Brain Engine Offline' : 'Synchronizing State...' }}</p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted, computed } from 'vue'\nimport { useGraphStore } from './stores/graphStore'\nimport ConceptGraph from './components/ConceptGraph.vue'\nimport GraphExplorer from './components/GraphExplorer.vue'\nimport ConfigPanel from './components/ConfigPanel.vue'\nimport AspectBar from './components/AspectBar.vue'\nimport InitialOnboarding from './components/InitialOnboarding.vue'\nimport BrainPanel from './components/BrainPanel.vue'\nimport NodeIcon from './components/NodeIcon.vue'\nimport type { GraphNode } from './types/graph'\n\nconst store = useGraphStore()\nconst codeGraphRef = ref<InstanceType<typeof ConceptGraph> | null>(null)\nconst selectedNodeId = ref<string | null>(null)\nconst selectedNode = computed(() => selectedNodeId.value ? store.state.nodes[selectedNodeId.value] : null)\n\nconst showConfig = ref(false)\nconst showBrainPanel = ref(false)\n\n// Use the store's computed island calculation\nconst graphIslands = computed(() => store.graphIslands);\n\nfunction handleOnboardingComplete(payload: { labels: string[], aspects: string[] }) {\n  store.send({ \n    type: 'UPDATE_SETTINGS', \n    settings: { ...store.state.settings, definedAspects: payload.aspects, activeAspects: payload.aspects.slice(0, 3) } \n  });\n  // Add all starting concepts\n  payload.labels.forEach(label => {\n    store.send({ type: 'ADD_NODE', label });\n  });\n}\n\nfunction onNodeSelect(node: GraphNode | null) {\n  selectedNodeId.value = node?.id || null\n  if (node) {\n     store.send({ type: 'SET_FOCUS', nodeId: node.id })\n     codeGraphRef.value?.focusNode(node.id)\n  }\n}\n\nfunction toggleAutoExplore(val: boolean) { \n  store.send({ type: 'UPDATE_SETTINGS', settings: { ...store.state.settings, autoExplore: val } });\n}\n\nfunction promptNewIndependentNode() { \n  const label = prompt('New independent concept:'); \n  if (label) store.send({ type: 'ADD_NODE', label }); \n}\n\nonMounted(() => {\n  store.connect()\n  window.addEventListener('update-settings', (e: any) => {\n    store.send({ type: 'UPDATE_SETTINGS', settings: { ...store.state.settings, ...e.detail } });\n  })\n  window.addEventListener('clear-graph', () => store.send({ type: 'CLEAR_GRAPH' }))\n})\n</script>\n\n<style>\n.custom-scrollbar::-webkit-scrollbar { width: 4px; }\n.custom-scrollbar::-webkit-scrollbar-track { background: transparent; }\n.custom-scrollbar::-webkit-scrollbar-thumb { background: #27272a; border-radius: 10px; }\n.custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #3f3f3f; }\n</style>"
    },
    {
      "filename": "src/components/AspectBar.vue",
      "content": "<template>\n  <div class=\"flex items-center gap-2 p-1 bg-zinc-900/40 backdrop-blur rounded-full border border-zinc-800 shadow-lg\">\n    <div class=\"flex gap-1 px-2\">\n      <div \n        v-for=\"aspect in definedAspects\" \n        :key=\"aspect\"\n        @click=\"toggleAspect(aspect)\"\n        class=\"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider cursor-pointer transition-all border\"\n        :class=\"isActive(aspect) \n          ? 'bg-indigo-600 border-indigo-500 text-white shadow-[0_0_10px_rgba(79,70,229,0.4)]' \n          : 'bg-zinc-800 border-zinc-700 text-zinc-500 hover:text-zinc-300'\"\n      >\n        {{ aspect }}\n      </div>\n    </div>\n    \n    <div class=\"h-4 w-px bg-zinc-800 mx-1\"></div>\n\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\n\nconst props = defineProps<{\n  definedAspects: string[],\n  activeAspects: string[]\n}>();\n\nconst newAspect = ref('');\n\nfunction isActive(a: string) {\n  return props.activeAspects.includes(a);\n}\n\nfunction toggleAspect(a: string) {\n  let next = [...props.activeAspects];\n  if (isActive(a)) next = next.filter(i => i !== a);\n  else next.push(a);\n  \n  window.dispatchEvent(new CustomEvent('update-settings', { \n    detail: { activeAspects: next } \n  }));\n}\n</script>"
    },
    {
      "filename": "src/components/BrainPanel.vue",
      "content": "<template>\n  <div class=\"bg-zinc-900/95 backdrop-blur border border-zinc-800 rounded-lg p-4 w-64 flex flex-col gap-4 text-xs shadow-xl\">\n    <div class=\"flex justify-between items-center\">\n      <h3 class=\"font-bold text-zinc-400 uppercase tracking-wider\">Brain Management</h3>\n      <div :class=\"statusColor\" class=\"w-2 h-2 rounded-full shadow-[0_0_8px_currentColor]\"></div>\n    </div>\n\n    <div class=\"space-y-3\">\n      <div class=\"flex flex-col gap-1.5\">\n        <label class=\"text-zinc-500 font-bold uppercase text-[9px]\">Model Size</label>\n        <div class=\"grid grid-cols-3 gap-1\">\n          <button \n            v-for=\"size in ['small', 'medium', 'large']\" \n            :key=\"size\"\n            @click=\"updateConfig({ selectedSize: size })\"\n            class=\"py-1.5 rounded border text-[10px] font-bold uppercase transition-all\"\n            :class=\"config.selectedSize === size ? 'bg-indigo-600 border-indigo-400 text-white' : 'bg-zinc-800 border-zinc-700 text-zinc-400 hover:text-zinc-200'\"\n          >\n            {{ size }}\n          </button>\n        </div>\n      </div>\n\n      <div class=\"pt-2 border-t border-zinc-800 flex flex-col gap-2\">\n        <button \n          v-if=\"status === 'unloaded' || status === 'error'\" \n          @click=\"$emit('load')\" \n          class=\"w-full py-2 bg-emerald-950/30 hover:bg-emerald-900/40 text-emerald-500 border border-emerald-900/50 rounded font-bold uppercase transition-all\"\n        >\n          Load Engine\n        </button>\n        <button \n          v-else \n          @click=\"$emit('unload')\" \n          :disabled=\"status === 'thinking'\"\n          class=\"w-full py-2 bg-red-950/20 hover:bg-red-900/40 text-red-500 border border-red-900/50 rounded font-bold uppercase transition-all disabled:opacity-50\"\n        >\n          Unload Engine\n        </button>\n      </div>\n\n      <label class=\"flex items-center gap-2 cursor-pointer group pt-1\">\n        <input \n          type=\"checkbox\" \n          :checked=\"config.loadOnStartup\" \n          @change=\"(e: any) => updateConfig({ loadOnStartup: e.target.checked })\" \n          class=\"w-3.5 h-3.5 accent-indigo-500\" \n        />\n        <span class=\"text-zinc-400 group-hover:text-zinc-200 transition-colors\">Load on startup</span>\n      </label>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue';\n\nconst props = defineProps<{\n  status: 'unloaded' | 'loading' | 'ready' | 'thinking' | 'error',\n  config: any\n}>();\n\nconst emit = defineEmits(['load', 'unload', 'updateConfig']);\n\nconst statusColor = computed(() => {\n  if (props.status === 'ready') return 'text-emerald-500 bg-emerald-500';\n  if (props.status === 'thinking') return 'text-indigo-500 bg-indigo-500 animate-pulse';\n  if (props.status === 'loading') return 'text-amber-500 bg-amber-500 animate-pulse';\n  if (props.status === 'unloaded') return 'text-zinc-600 bg-zinc-600';\n  return 'text-red-500 bg-red-500';\n});\n\nfunction updateConfig(patch: any) {\n  emit('updateConfig', { ...props.config, ...patch });\n}\n</script>"
    },
    {
      "filename": "src/components/ConceptGraph.vue",
      "content": "<template>\n  <div ref=\"container\" class=\"w-full h-full\" @contextmenu.prevent></div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted, onBeforeUnmount, watch, shallowRef } from 'vue'\nimport * as THREE from 'three'\nimport ForceGraph3D, { type ForceGraph3DInstance } from '3d-force-graph'\nimport SpriteText from 'three-spritetext'\nimport type { GraphNode, GraphLink, GraphSettings } from '../types/graph'\nimport { useGraphConfigStore } from '../stores/graphConfig'\n\nconst props = defineProps<{\n  nodes: GraphNode[]\n  links: GraphLink[]\n  settings: GraphSettings\n  selectedNodeId?: string | null\n  thinkingNodeId?: string | null\n}>()\n\nconst emit = defineEmits<{ (e: 'select', node: GraphNode | null): void }>()\n\n// --- Physics & Visual Constants ---\nconst PHYSICS = {\n  TRANSITION_SPEED: 0.04,\n  LINK_DISTANCE: 35,\n  LINK_STRENGTH_BASE: 0.4,\n  ASPECT_FILTER_LINK_MULT: 0.1, // Reduction when filtering\n  CHARGE_STRENGTH: -120,\n  ASPECT_FILTER_CHARGE_MULT: 0.4, \n  CHARGE_DYNAMICS: { base: 1.2, multiplier: 0.4 },\n  CENTER_GRAVITY_K: 0.08,\n  CENTER_GRAVITY_SCORE_BIAS: 5,\n  SIMILARITY_K: 0.01,\n  SIMILARITY_THRESHOLD: 0.85,\n  SIMILARITY_FORCE_MULTIPLIER: 0.5,\n  VELOCITY_DECAY: 0.4,\n  NODE_SIZE_RANGE: { min: 1, max: 15 },\n  NODE_REL_SIZE: 1.5,\n  FOCUS_DISTANCE: 80,\n  SCORE_THRESHOLDS: { irrelevant: 0.25, relevant: 0.85, center: 0.5, high: 0.7 }\n};\n\nconst container = ref<HTMLElement | null>(null)\nconst config = useGraphConfigStore()\nconst graph = shallowRef<ForceGraph3DInstance | null>(null)\nlet resizeObserver: ResizeObserver | null = null\nlet updateTimer: number | null = null;\n\n// Physics and Animation state\nconst nodePhysicsData = new Map<string, { currentScore: number, targetScore: number }>();\nlet transitionAlpha = 1.0;\nlet currentLinkMult = 1.0;\nlet targetLinkMult = 1.0;\nlet currentChargeMult = 1.0;\nlet targetChargeMult = 1.0;\n\n// Clock for pulsing animations\nconst clock = new THREE.Clock();\n\nfunction cosineSimilarity(a: Record<string, number>, b: Record<string, number>, aspects: string[]) {\n  if (!aspects.length) return 0;\n  let dot = 0, mA = 0, mB = 0;\n  for (const k of aspects) {\n    const valA = a[k] || 0;\n    const valB = b[k] || 0;\n    dot += valA * valB;\n    mA += valA * valA;\n    mB += valB * valB;\n  }\n  const mag = Math.sqrt(mA) * Math.sqrt(mB);\n  return mag === 0 ? 0 : dot / mag;\n}\n\nfunction calculateNodeScore(node: GraphNode, active: string[]): number {\n  if (!active || active.length === 0) return 0.5;\n  const aspects = node.aspects || {};\n  let sum = 0, count = 0;\n  for (const key of active) {\n    if (typeof aspects[key] === 'number') {\n      sum += aspects[key]; count++;\n    }\n  }\n  return count > 0 ? sum / count : 0.2;\n}\n\nfunction scheduleUpdate() {\n  if (updateTimer) return;\n  updateTimer = window.requestAnimationFrame(() => {\n    updateData();\n    updateTimer = null;\n  });\n}\n\nwatch(() => props.nodes.length, scheduleUpdate);\nwatch(() => props.links.length, scheduleUpdate);\n\nwatch(() => props.settings.activeAspects, (active) => {\n  props.nodes.forEach(n => {\n    const data = nodePhysicsData.get(n.id) || { currentScore: 0.5, targetScore: 0.5 };\n    data.targetScore = calculateNodeScore(n, active);\n    nodePhysicsData.set(n.id, data);\n  });\n  \n  const isFiltering = active.length > 0;\n  targetLinkMult = isFiltering ? PHYSICS.ASPECT_FILTER_LINK_MULT : 1.0;\n  targetChargeMult = isFiltering ? PHYSICS.ASPECT_FILTER_CHARGE_MULT : 1.0;\n\n  transitionAlpha = 0;\n  if (graph.value) graph.value.d3ReheatSimulation();\n}, { deep: true, immediate: true });\n\nwatch(() => props.thinkingNodeId, () => {\n  if (graph.value) graph.value.nodeThreeObject(graph.value.nodeThreeObject());\n});\n\nfunction updateData() {\n  if (!graph.value) return;\n  const currentData = graph.value.graphData();\n  const nodeMap = new Map(currentData.nodes.map((n: any) => [n.id, n]));\n  \n  const nextNodes = props.nodes.map(n => {\n    const existing = nodeMap.get(n.id);\n    if (existing) return Object.assign(existing, n);\n    const newNode = { ...n };\n    nodePhysicsData.set(n.id, { currentScore: 0.5, targetScore: calculateNodeScore(n, props.settings.activeAspects) });\n    return newNode;\n  });\n\n  graph.value.graphData({\n    nodes: nextNodes,\n    links: props.links.map(l => ({ ...l }))\n  });\n}\n\nfunction createThinkingHalo() {\n  const geometry = new THREE.SphereGeometry(6, 32, 32);\n  const material = new THREE.MeshBasicMaterial({\n    color: 0x10b981,\n    transparent: true,\n    opacity: 0.2,\n    side: THREE.BackSide\n  });\n  const halo = new THREE.Mesh(geometry, material);\n  halo.name = 'thinking-halo';\n  return halo;\n}\n\nfunction initGraph() {\n  if (!container.value) return;\n  \n  const g = new ForceGraph3D(container.value)\n    .backgroundColor('#19191d')\n    .nodeColor(node => getHealthColor(node as GraphNode))\n    .nodeVal(node => {\n      const score = nodePhysicsData.get((node as any).id)?.currentScore || 0.5;\n      return PHYSICS.NODE_SIZE_RANGE.min + (PHYSICS.NODE_SIZE_RANGE.max - PHYSICS.NODE_SIZE_RANGE.min) * score;\n    })\n    .nodeThreeObject(node => {\n      const gNode = node as GraphNode;\n      const group = new THREE.Group();\n\n      // Label\n      var text = gNode.label\n      if(gNode.emoji) \n        text = `${gNode.emoji} ${text}`\n      const sprite = new SpriteText(text);\n      sprite.color = '#ffffff';\n      sprite.textHeight = config.labelSize * 4;\n      sprite.center.y = -1.2;\n      group.add(sprite);\n\n      // Thinking Aura\n      if (props.thinkingNodeId === gNode.id) {\n        group.add(createThinkingHalo());\n      }\n\n      return group;\n    })\n    .nodeThreeObjectExtend(true)\n    .linkColor(() => 'rgba(255,255,255,0.15)')\n    .onNodeClick((node: any) => {\n      emit('select', node);\n      performFocus(node);\n    });\n\n  // Forces\n  g.d3Force('link')?.distance(PHYSICS.LINK_DISTANCE).strength(link => {\n    const s = nodePhysicsData.get((link.source as any).id)?.currentScore || 0.5;\n    const t = nodePhysicsData.get((link.target as any).id)?.currentScore || 0.5;\n    const isFiltering = props.settings.activeAspects.length > 0;\n    const mult = isFiltering ? currentLinkMult : 1.0;\n    return PHYSICS.LINK_STRENGTH_BASE * ((s + t) / 2) * mult;\n  });\n\n  g.d3Force('charge')?.strength(node => {\n    const score = nodePhysicsData.get((node as any).id)?.currentScore || 0.5;\n    const strength = PHYSICS.CHARGE_STRENGTH * (PHYSICS.CHARGE_DYNAMICS.base - score * PHYSICS.CHARGE_DYNAMICS.multiplier);\n    return strength * currentChargeMult;\n  });\n\n  g.d3Force('aspectCenter', (alpha: number) => {\n    const nodes = g.graphData().nodes;\n    const k = PHYSICS.CENTER_GRAVITY_K * alpha;\n    nodes.forEach((n: any) => {\n      const score = nodePhysicsData.get(n.id)?.currentScore || 0.5;\n      n.vx += (0 - n.x) * k * score * PHYSICS.CENTER_GRAVITY_SCORE_BIAS;\n      n.vy += (0 - n.y) * k * score * PHYSICS.CENTER_GRAVITY_SCORE_BIAS;\n      n.vz += (0 - n.z) * k * score * PHYSICS.CENTER_GRAVITY_SCORE_BIAS;\n    });\n  });\n\n  g.d3Force('similarity', (alpha: number) => {\n    const nodes = g.graphData().nodes;\n    if (nodes.length > 80) return; \n    const k = PHYSICS.SIMILARITY_K * alpha;\n    const allAspects = props.settings.definedAspects;\n    if (allAspects.length === 0) return;\n\n    for (let i = 0; i < nodes.length; i++) {\n      for (let j = i + 1; j < nodes.length; j++) {\n        const a = nodes[i] as any;\n        const b = nodes[j] as any;\n        const sim = cosineSimilarity(a.aspects || {}, b.aspects || {}, allAspects);\n        if (sim > PHYSICS.SIMILARITY_THRESHOLD) {\n          const dx = b.x - a.x, dy = b.y - a.y, dz = b.z - a.z;\n          const f = sim * k * PHYSICS.SIMILARITY_FORCE_MULTIPLIER;\n          a.vx += dx * f; a.vy += dy * f; a.vz += dz * f;\n          b.vx -= dx * f; b.vy -= dy * f; b.vz -= dz * f;\n        }\n      }\n    }\n  });\n\n  // Animation & Transition Loop\n  g.d3Force('transition', () => {\n    const elapsed = clock.getElapsedTime();\n    const lerpFactor = PHYSICS.TRANSITION_SPEED * 2.5;\n\n    if (transitionAlpha < 1.0) {\n      transitionAlpha = Math.min(1.0, transitionAlpha + PHYSICS.TRANSITION_SPEED);\n      nodePhysicsData.forEach((data) => {\n        data.currentScore += (data.targetScore - data.currentScore) * lerpFactor;\n      });\n      currentLinkMult += (targetLinkMult - currentLinkMult) * lerpFactor;\n      currentChargeMult += (targetChargeMult - currentChargeMult) * lerpFactor;\n      \n      g.nodeColor(g.nodeColor());\n      g.nodeVal(g.nodeVal());\n      const lForce: any = g.d3Force('link');\n      if (lForce) lForce.strength(lForce.strength());\n      const cForce: any = g.d3Force('charge');\n      if (cForce) cForce.strength(cForce.strength());\n    }\n\n    // Animate Thinking Halos\n    g.graphData().nodes.forEach((node: any) => {\n      if (node.__threeObj && props.thinkingNodeId === node.id) {\n        const halo = node.__threeObj.getObjectByName('thinking-halo');\n        if (halo) {\n          const pulse = (Math.sin(elapsed * 4) + 1) / 2;\n          halo.scale.setScalar(1.2 + pulse * 0.4);\n          halo.material.opacity = 0.1 + pulse * 0.2;\n        }\n      }\n    });\n  });\n\n  g.nodeRelSize(PHYSICS.NODE_REL_SIZE)\n   .linkWidth(config.linkWidth)\n   .linkOpacity(config.linkOpacity)\n   .linkDirectionalParticles(config.linkDirectionalParticles)\n   .linkCurvature(0.1)\n   .d3VelocityDecay(PHYSICS.VELOCITY_DECAY);\n\n  graph.value = g;\n  updateData();\n}\n\nfunction getHealthColor(node: GraphNode) {\n  if (node.status === 'forbidden') return '#450a0a';\n  if (props.thinkingNodeId === node.id) return '#10b981';\n  const data = nodePhysicsData.get(node.id);\n  const score = data ? data.currentScore : 0.5;\n  return '#' + getAspectColor(score).getHexString();\n}\n\nfunction lerp(a: number, b: number, t: number) {\n  return a + (b - a) * t;\n}\n\nfunction getAspectColor(value: number): THREE.Color {\n  const v = THREE.MathUtils.clamp(value, 0, 1);\n\n  const hueStops = [\n    { t: 0.0, h: 220 / 360 }, // blue\n    { t: 0.5, h: 140 / 360 }, // green\n    { t: 0.66, h: 35 / 360 },  // orange\n    { t: 1.0, h: 0 / 360 }     // red\n  ];\n\n  for (let i = 0; i < hueStops.length - 1; i++) {\n    const s1 = hueStops[i];\n    const s2 = hueStops[i + 1];\n\n    if (v >= s1.t && v <= s2.t) {\n      const localT = (v - s1.t) / (s2.t - s1.t);\n      const hue = lerp(s1.h, s2.h, localT);\n\n      const color = new THREE.Color();\n      color.setHSL(hue, 0.8, 0.55); // saturation, lightness\n      return color;\n    }\n  }\n\n  // fallback (should never happen)\n  const fallback = new THREE.Color();\n  fallback.setHSL(0, 0.8, 0.55);\n  return fallback;\n}\n\nfunction performFocus(node: any) {\n  if (!graph.value) return;\n  const distance = PHYSICS.FOCUS_DISTANCE;\n  const distRatio = 1 + distance / Math.hypot(node.x || 0, node.y || 0, node.z || 0);\n  const newPos = (node.x || node.y || node.z)\n    ? { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio }\n    : { x: 0, y: 0, z: distance };\n  graph.value.cameraPosition(newPos, node, 2000);\n}\n\nwatch(() => config.linkOpacity, (val) => {\n  if (graph.value) graph.value.linkOpacity(val);\n});\n\nwatch(() => config.labelSize, () => {\n  if (graph.value) graph.value.nodeThreeObject(graph.value.nodeThreeObject());\n});\n\nonMounted(() => {\n  initGraph();\n  resizeObserver = new ResizeObserver(() => {\n    if (graph.value && container.value) {\n      graph.value.width(container.value.clientWidth);\n      graph.value.height(container.value.clientHeight);\n    }\n  });\n  resizeObserver.observe(container.value!);\n});\n\nonBeforeUnmount(() => {\n  if (updateTimer) cancelAnimationFrame(updateTimer);\n  resizeObserver?.disconnect();\n  graph.value?._destructor();\n});\n\ndefineExpose({\n  focusNode: (id: string) => {\n    if (!graph.value) return;\n    const simNodes = graph.value.graphData().nodes as any[];\n    const node = simNodes.find(n => n.id === id);\n    if (node) performFocus(node);\n  },\n  reheat: () => graph.value?.d3ReheatSimulation()\n})\n</script>"
    },
    {
      "filename": "src/components/ConfigPanel.vue",
      "content": "<template>\n  <div class=\"bg-zinc-900/95 backdrop-blur border border-zinc-800 rounded-lg p-4 w-72 flex flex-col gap-3 text-xs text-zinc-300 shadow-xl\">\n    <h3 class=\"font-bold text-zinc-400 uppercase tracking-wider mb-1\">Brain Engine Config</h3>\n    \n    <div class=\"space-y-1\">\n      <label class=\"flex justify-between\">AI Creativity <span>{{ store.state.settings.creativity }}</span></label>\n      <input type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" :value=\"store.state.settings.creativity\" @input=\"(e: any) => updateServerSettings({ creativity: parseFloat(e.target.value) })\" class=\"w-full accent-indigo-500\" />\n    </div>\n\n    <div class=\"space-y-1\">\n      <label class=\"flex justify-between\">Min AI Connections <span>{{ store.state.settings.minConnections }}</span></label>\n      <input type=\"range\" min=\"1\" max=\"10\" step=\"1\" :value=\"store.state.settings.minConnections\" @input=\"(e: any) => updateServerSettings({ minConnections: parseInt(e.target.value) })\" class=\"w-full accent-indigo-500\" />\n    </div>\n\n    <h3 class=\"font-bold text-zinc-400 uppercase tracking-wider mt-2 pt-3 border-t border-zinc-800\">Visuals</h3>\n    <div class=\"space-y-1\">\n      <label class=\"flex justify-between text-zinc-500\">Link Opacity <span>{{ config.linkOpacity }}</span></label>\n      <input type=\"range\" min=\"0\" max=\"1\" step=\"0.05\" v-model.number=\"config.linkOpacity\" class=\"w-full accent-blue-500\" />\n    </div>\n    <div class=\"space-y-1\">\n      <label class=\"flex justify-between text-zinc-500\">Label Size <span>{{ config.labelSize }}</span></label>\n      <input type=\"range\" min=\"0.1\" max=\"3\" step=\"0.1\" v-model.number=\"config.labelSize\" class=\"w-full accent-blue-500\" />\n    </div>\n\n    <div class=\"pt-2 border-t border-zinc-700/50 flex flex-col gap-2\">\n       <button @click=\"clearGraph\" class=\"w-full py-2 bg-red-950/20 hover:bg-red-900/40 text-red-500 border border-red-900/50 rounded text-[10px] font-bold uppercase transition-all\">Clear All Concepts</button>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useGraphConfigStore } from '../stores/graphConfig'\nimport { useGraphStore } from '../stores/graphStore'\n\nconst config = useGraphConfigStore()\nconst store = useGraphStore()\n\nfunction updateServerSettings(patch: any) {\n  window.dispatchEvent(new CustomEvent('update-settings', { detail: patch }))\n}\n\nfunction clearGraph() {\n  if (confirm('Are you sure you want to delete all concepts?')) {\n    window.dispatchEvent(new CustomEvent('clear-graph'))\n  }\n}\n</script>"
    },
    {
      "filename": "src/components/Discover.vue",
      "content": "<template>\n<div class=\"flex gap-2 max-h-[90vh] pointer-events-auto items-start\">\n    <div v-if=\"selectedNode\" class=\"w-80 bg-zinc-900/95 backdrop-blur-md border border-zinc-800 rounded-lg p-4 shadow-xl text-zinc-100 flex flex-col overflow-hidden\">\n    </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { useGraphStore } from '../stores/graphStore'\nimport type { GraphNode } from '../types/graph'\nimport NodeIcon from './NodeIcon.vue'\n\nconst store = useGraphStore()\nconst props = defineProps<{ selectedNode: GraphNode | null }>()\nconst emit = defineEmits<{ (e: 'select', n: any): void }>()\n\n</script>"
    },
    {
      "filename": "src/components/GraphExplorer.vue",
      "content": "<template>\n  <div class=\"flex gap-2 max-h-[90vh] pointer-events-auto items-start\">\n    <div v-if=\"selectedNode\" class=\"w-80 bg-zinc-900/95 backdrop-blur-md border border-zinc-800 rounded-lg p-4 shadow-xl text-zinc-100 flex flex-col overflow-hidden\">\n        <div class=\"flex justify-between items-start mb-2\">\n            <div class=\"p-1.5 bg-zinc-800/50 rounded-lg border border-zinc-700/50\">\n                 <NodeIcon :type=\"selectedNode.status === 'proposed' ? 'function' : 'file'\" :color=\"getNodeColor(selectedNode)\" class=\"w-6 h-6\" />\n            </div>\n            <div class=\"flex gap-1\">\n              <button @click=\"store.send({ type: 'FORBID_NODE', nodeId: selectedNode.id })\" class=\"p-1.5 rounded transition-colors\" :class=\"selectedNode.status === 'forbidden' ? 'text-red-500 bg-red-950/40' : 'text-zinc-600 hover:text-red-400'\" title=\"Forbid Context\">\n                 <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"4.93\" y1=\"4.93\" x2=\"19.07\" y2=\"19.07\"></line></svg>\n              </button>\n              <button @click=\"deleteNode\" class=\"p-1.5 text-zinc-600 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors\" title=\"Delete Concept\">\n                 <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"3 6 5 6 21 6\"></polyline><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path></svg>\n              </button>\n              <button @click=\"$emit('select', null)\" class=\"p-1.5 text-zinc-600 hover:text-zinc-400\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>\n              </button>\n            </div>\n        </div>\n\n        <div class=\"mb-4\">\n          <h2 class=\"text-xl font-bold text-white break-words leading-tight\">{{ selectedNode.label }}</h2>\n          <div v-if=\"selectedNode.description\" class=\"mt-3 p-3 bg-zinc-950/50 rounded-lg border border-zinc-800/50\">\n            <p class=\"text-[13px] text-zinc-300 leading-relaxed font-medium\">{{ selectedNode.description }}</p>\n          </div>\n          <div class=\"flex items-center gap-2 mt-1\">\n            <span class=\"text-[9px] uppercase tracking-widest text-zinc-500 font-mono\">{{ selectedNode.status }} {{ selectedNode.type }}</span>\n            <span v-if=\"store.state.thinkingNodeId === selectedNode.id\" class=\"text-[9px] text-indigo-400 animate-pulse font-bold uppercase italic\">AI is dreaming...</span>\n          </div>\n        </div>\n\n        <div class=\"flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-4 max-h-120\">\n            <div v-if=\"hasAspects\">\n                <h3 class=\"text-[10px] uppercase tracking-wider text-zinc-500 font-bold mb-2 border-b border-zinc-800 pb-1\">Aspect Relevance</h3>\n                <div class=\"space-y-2 max-h-40 overflow-y-auto custom-scrollbar\">\n                    <div v-for=\"(val, name) in selectedNode.aspects\" :key=\"name\" class=\"flex flex-col gap-1\">\n                        <div class=\"flex justify-between text-[10px] text-zinc-400\">\n                            <span>{{ name }}</span>\n                            <span>{{ (val * 100).toFixed(0) }}%</span>\n                        </div>\n                        <div class=\"h-1 bg-zinc-800 rounded-full overflow-hidden\">\n                            <div class=\"h-full bg-indigo-500 shadow-[0_0_5px_#6366f1]\" :style=\"{ width: (val * 100) + '%' }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div v-if=\"incomingLinks.length > 0\">\n                <h3 class=\"text-[10px] uppercase tracking-wider text-zinc-500 font-bold mb-2 border-b border-zinc-800 pb-1\">Related By</h3>\n                <div class=\"flex flex-col gap-1 max-h-40 overflow-y-auto custom-scrollbar pr-1\">\n                    <div v-for=\"ref in incomingLinks\" :key=\"ref.id\" @click=\"$emit('select', ref.node)\" class=\"cursor-pointer text-xs p-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-zinc-200 truncate border border-transparent hover:border-zinc-700 flex items-center justify-between\">\n                        <div class=\"flex items-center gap-2 truncate\">\n                          <NodeIcon :type=\"ref.node.status === 'proposed' ? 'function' : 'file'\" :color=\"getNodeColor(ref.node)\" class=\"w-2.5 h-2.5\" />\n                          <span class=\"truncate\">{{ ref.node.label }}</span>\n                        </div>\n                        <span class=\"text-[9px] text-zinc-600 italic\">{{ ref.type }}</span>\n                    </div>\n                </div>\n            </div>\n\n            <div v-if=\"outgoingLinks.length > 0\">\n                <h3 class=\"text-[10px] uppercase tracking-wider text-zinc-500 font-bold mb-2 border-b border-zinc-800 pb-1\">Leads To</h3>\n                <div class=\"flex flex-col gap-1 max-h-40 overflow-y-auto custom-scrollbar pr-1\">\n                    <div v-for=\"dep in outgoingLinks\" :key=\"dep.id\" @click=\"$emit('select', dep.node)\" class=\"cursor-pointer text-xs p-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-zinc-200 truncate border border-transparent hover:border-zinc-700 flex items-center justify-between\">\n                        <div class=\"flex items-center gap-2 truncate\">\n                          <NodeIcon :type=\"dep.node.status === 'proposed' ? 'function' : 'file'\" :color=\"getNodeColor(dep.node)\" class=\"w-2.5 h-2.5\" />\n                          <span class=\"truncate\">{{ dep.node.label }}</span>\n                        </div>\n                        <span class=\"text-[9px] text-zinc-600 italic\">{{ dep.type }}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"mt-4 pt-4 border-t border-zinc-800 space-y-2\">\n           <div class=\"relative\">\n             <input v-model=\"relatedInput\" @keyup.enter=\"addRelated\" placeholder=\"Add connection...\" class=\"w-full bg-zinc-950 border border-zinc-800 rounded px-3 py-2 text-xs text-white focus:outline-none focus:border-indigo-500\" />\n             <button @click=\"addRelated\" class=\"absolute right-2 top-1.5 text-zinc-500 hover:text-indigo-400\">\n               <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>\n             </button>\n           </div>\n           \n           <button v-if=\"selectedNode.status === 'proposed'\" @click=\"store.send({ type: 'ACCEPT_NODE', nodeId: selectedNode.id })\" class=\"w-full bg-indigo-600 hover:bg-indigo-500 text-white text-xs py-2 rounded font-bold\">Accept AI Suggestion</button>\n           \n           <div v-if=\"selectedNode.status === 'accepted'\" class=\"grid grid-cols-2 gap-2\">\n              <button @click=\"store.send({ type: 'EXPLORE_NEW', nodeId: selectedNode.id })\" :disabled=\"store.state.thinkingNodeId !== null\" class=\"bg-zinc-800 hover:bg-indigo-900/40 text-[10px] py-2 rounded font-bold text-zinc-300 border border-zinc-700 disabled:opacity-50\">Discover New</button>\n              <button @click=\"store.send({ type: 'EXPLORE_EXISTING', nodeId: selectedNode.id })\" :disabled=\"store.state.thinkingNodeId !== null\" class=\"bg-zinc-800 hover:bg-emerald-900/40 text-[10px] py-2 rounded font-bold text-zinc-300 border border-zinc-700 disabled:opacity-50\">Link Existing</button>\n           </div>\n\n           <button v-if=\"selectedNode.status === 'accepted'\" @click=\"store.send({ type: 'UPDATE_NODE_ASPECTS', nodeId: selectedNode.id })\" :disabled=\"store.state.thinkingNodeId !== null\" class=\"w-full mt-2 bg-zinc-800 hover:bg-amber-900/30 text-[10px] py-2 rounded font-bold text-zinc-400 border border-zinc-700 transition-colors\">\n             Update Aspect Weights\n           </button>\n        </div>\n    </div>\n    <div v-else class=\"w-64 bg-zinc-900/50 backdrop-blur border border-zinc-800/50 p-4 rounded-lg text-center pointer-events-auto\">\n       <p class=\"text-zinc-600 text-xs\">Select a node to navigate the landscape</p>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { useGraphStore } from '../stores/graphStore'\nimport type { GraphNode } from '../types/graph'\nimport NodeIcon from './NodeIcon.vue'\n\nconst store = useGraphStore()\nconst props = defineProps<{ selectedNode: GraphNode | null }>()\nconst emit = defineEmits<{ (e: 'select', n: any): void }>()\n\nconst relatedInput = ref('')\nfunction addRelated() { if (relatedInput.value && props.selectedNode) { store.send({ type: 'ADD_NODE', label: relatedInput.value, parentId: props.selectedNode.id }); relatedInput.value = '' } }\nfunction deleteNode() { if (props.selectedNode) { store.send({ type: 'DELETE_NODE', nodeId: props.selectedNode.id }); emit('select', null); } }\n\nfunction getNodeColor(node: GraphNode) {\n    if (node.status === 'forbidden') return '#ef4444'\n    if (store.state.thinkingNodeId === node.id) return '#22c55e'\n    if (node.type === 'root') return '#f43f5e'\n    return node.status === 'accepted' ? '#3b82f6' : '#71717a'\n}\n\nconst hasAspects = computed(() => props.selectedNode && Object.keys(props.selectedNode.aspects || {}).length > 0);\n\nconst outgoingLinks = computed(() => {\n    if (!props.selectedNode) return []\n    return store.linksArray\n        .filter(l => (typeof l.source === 'string' ? l.source : l.source.id) === props.selectedNode!.id)\n        .map(l => ({ node: store.state.nodes[typeof l.target === 'string' ? l.target : l.target.id], type: l.relationType }))\n        .filter(n => !!n.node)\n})\n\nconst incomingLinks = computed(() => {\n    if (!props.selectedNode) return []\n    return store.linksArray\n        .filter(l => (typeof l.target === 'string' ? l.target : l.target.id) === props.selectedNode!.id)\n        .map(l => ({ node: store.state.nodes[typeof l.source === 'string' ? l.source : l.source.id], type: l.relationType }))\n        .filter(n => !!n.node)\n})\n</script>"
    },
    {
      "filename": "src/components/InitialOnboarding.vue",
      "content": "<template>\n  <div class=\"bg-zinc-900 border border-zinc-800 p-8 rounded-2xl shadow-2xl w-full max-w-2xl\">\n    <h2 class=\"text-2xl font-bold text-white mb-2 text-center\">Initialize Workspace</h2>\n    <p class=\"text-zinc-500 text-sm mb-8 text-center\">Define your starting concepts and the semantic dimensions to explore.</p>\n\n    <div class=\"grid grid-cols-2 gap-8 mb-8\">\n      <!-- Concepts Column -->\n      <div class=\"flex flex-col gap-4\">\n        <h3 class=\"text-[10px] font-bold uppercase tracking-widest text-indigo-400\">Starting Concepts</h3>\n        <div class=\"flex flex-col gap-2 max-h-60 overflow-y-auto custom-scrollbar pr-2\">\n          <div \n            v-for=\"(c, idx) in concepts\" \n            :key=\"idx\" \n            class=\"group flex items-center justify-between bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-2 text-sm text-white animate-in fade-in slide-in-from-left-2\"\n          >\n            <span class=\"truncate\">{{ c }}</span>\n            <button @click=\"removeConcept(idx)\" class=\"opacity-0 group-hover:opacity-100 text-zinc-600 hover:text-red-500 transition-all\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>\n            </button>\n          </div>\n        </div>\n        <div class=\"relative\">\n          <input \n            v-model=\"newConcept\"\n            @keyup.enter=\"addConcept\"\n            placeholder=\"Add concept...\"\n            class=\"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-2 text-xs text-white focus:outline-none focus:border-indigo-500 transition-all\"\n          />\n          <button @click=\"addConcept\" class=\"absolute right-2 top-1.5 text-zinc-500 hover:text-indigo-400\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>\n          </button>\n        </div>\n      </div>\n\n      <!-- Aspects Column -->\n      <div class=\"flex flex-col gap-4\">\n        <h3 class=\"text-[10px] font-bold uppercase tracking-widest text-emerald-400\">Semantic Aspects</h3>\n        <div class=\"flex flex-col gap-2 max-h-60 overflow-y-auto custom-scrollbar pr-2\">\n          <div \n            v-for=\"(a, idx) in aspects\" \n            :key=\"idx\" \n            class=\"group flex items-center justify-between bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-2 text-sm text-white animate-in fade-in slide-in-from-right-2\"\n          >\n            <span class=\"truncate italic\">{{ a }}</span>\n            <button @click=\"removeAspect(idx)\" class=\"opacity-0 group-hover:opacity-100 text-zinc-600 hover:text-red-500 transition-all\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>\n            </button>\n          </div>\n        </div>\n        <div class=\"relative\">\n          <input \n            v-model=\"newAspect\"\n            @keyup.enter=\"addAspect\"\n            placeholder=\"Add aspect...\"\n            class=\"w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-2 text-xs text-white focus:outline-none focus:border-emerald-500 transition-all\"\n          />\n          <button @click=\"addAspect\" class=\"absolute right-2 top-1.5 text-zinc-500 hover:text-emerald-400\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <button \n      @click=\"start\" \n      :disabled=\"concepts.length === 0 || aspects.length === 0\"\n      class=\"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-30 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all transform active:scale-[0.98] uppercase tracking-widest text-xs\"\n    >\n      Begin Exploration\n    </button>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\n\nconst emit = defineEmits<{ (e: 'start', payload: { labels: string[], aspects: string[] }): void }>();\n\nconst concepts = ref<string[]>([]);\nconst aspects = ref<string[]>([]);\n\nconst newConcept = ref('');\nconst newAspect = ref('');\n\nfunction addConcept() {\n  if (newConcept.value.trim()) {\n    concepts.value.push(newConcept.value.trim());\n    newConcept.value = '';\n  }\n}\n\nfunction removeConcept(idx: number) {\n  concepts.value.splice(idx, 1);\n}\n\nfunction addAspect() {\n  if (newAspect.value.trim()) {\n    aspects.value.push(newAspect.value.trim());\n    newAspect.value = '';\n  }\n}\n\nfunction removeAspect(idx: number) {\n  aspects.value.splice(idx, 1);\n}\n\nfunction start() {\n  emit('start', { labels: [...concepts.value], aspects: [...aspects.value] });\n}\n</script>\n\n<style scoped>\n.animate-in {\n  animation-duration: 0.3s;\n  animation-fill-mode: both;\n}\n</style>"
    },
    {
      "filename": "src/components/NodeIcon.vue",
      "content": "<template>\n  <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"inline-block shrink-0\">\n    <!-- File: Sphere -> Circle -->\n    <circle v-if=\"type === 'file'\" cx=\"12\" cy=\"12\" r=\"8\" :fill=\"fillColor\" stroke=\"currentColor\" stroke-width=\"2\" stroke-opacity=\"0.2\" />\n    \n    <!-- Class: Box -> Square -->\n    <rect v-else-if=\"type === 'class'\" x=\"5\" y=\"5\" width=\"14\" height=\"14\" rx=\"2\" :fill=\"fillColor\" stroke=\"currentColor\" stroke-width=\"2\" stroke-opacity=\"0.2\" />\n    \n    <!-- Function: Cone -> Triangle -->\n    <path v-else-if=\"type === 'function'\" d=\"M12 3L21 20H3L12 3Z\" :fill=\"fillColor\" stroke=\"currentColor\" stroke-width=\"2\" stroke-opacity=\"0.2\" />\n    \n    <!-- Cluster (Default) -->\n    <g v-else>\n       <circle cx=\"8\" cy=\"8\" r=\"4\" :fill=\"fillColor\" opacity=\"0.9\" />\n       <circle cx=\"16\" cy=\"16\" r=\"4\" :fill=\"fillColor\" opacity=\"0.7\" />\n       <circle cx=\"16\" cy=\"8\" r=\"4\" :fill=\"fillColor\" opacity=\"0.8\" />\n       <circle cx=\"8\" cy=\"16\" r=\"4\" :fill=\"fillColor\" opacity=\"0.6\" />\n    </g>\n  </svg>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nconst props = defineProps<{\n  type: string\n  color?: string\n}>()\n\nconst fillColor = computed(() => props.color || 'currentColor')\n</script>\n"
    },
    {
      "filename": "src/main.ts",
      "content": "import { createApp } from 'vue'\nimport { createPinia } from 'pinia'\nimport piniaPluginPersistedstate from 'pinia-plugin-persistedstate'\nimport './style.css'\nimport App from './App.vue'\n\nconst pinia = createPinia()\npinia.use(piniaPluginPersistedstate)\n\nconst app = createApp(App)\napp.use(pinia)\napp.mount('#app')\n"
    },
    {
      "filename": "src/stores/graphConfig.ts",
      "content": "import { defineStore } from \"pinia\";\nimport { ref } from \"vue\";\n\nexport const useGraphConfigStore = defineStore(\n\t\"graphConfig\",\n\t() => {\n\t\t// Appearance\n\t\tconst backgroundColor = ref(\"#19191d\");\n\t\tconst nodeColor = ref(\"#cccccc\");\n\t\tconst linkColor = ref(\"#555555\");\n\n\t\t// Physics & Layout\n\t\tconst nodeRelSize = ref(1); // Multiplier for node sphere size\n\t\tconst linkWidth = ref(0.5);\n\t\tconst linkOpacity = ref(0.5);\n\t\tconst linkDirectionalParticles = ref(0);\n\t\tconst linkDirectionalParticleSpeed = ref(0.005);\n\n\t\t// Labels\n\t\tconst labelSize = ref(1);\n\n\t\t// Forces\n\t\tconst chargeStrength = ref(-20);\n\t\tconst distanceMax = ref(400);\n\n\t\t// Engine & Advanced\n\t\tconst forceEngine = ref<\"d3\" | \"ngraph\">(\"d3\");\n\t\tconst numDimensions = ref<1 | 2 | 3>(3);\n\t\tconst dagMode = ref<string>(\"null\");\n\t\tconst dagLevelDistance = ref(50);\n\t\tconst warmupTicks = ref(0);\n\t\tconst cooldownTicks = ref(15000); // -1 for infinite\n\n\t\tfunction reset() {\n\t\t\tbackgroundColor.value = \"#19191d\";\n\t\t\tnodeRelSize.value = 4;\n\t\t\tlinkWidth.value = 0.5;\n\t\t\tlinkOpacity.value = 0.5;\n\t\t\tlabelSize.value = 1;\n\t\t\tlinkDirectionalParticles.value = 0;\n\t\t\tchargeStrength.value = -20;\n\t\t\tforceEngine.value = \"d3\";\n\t\t\tnumDimensions.value = 3;\n\t\t\tdagMode.value = \"null\";\n\t\t\tdagLevelDistance.value = 50;\n\t\t\twarmupTicks.value = 0;\n\t\t\tcooldownTicks.value = 15000;\n\t\t}\n\n\t\treturn {\n\t\t\tbackgroundColor,\n\t\t\tnodeColor,\n\t\t\tlinkColor,\n\t\t\tnodeRelSize,\n\t\t\tlinkWidth,\n\t\t\tlinkOpacity,\n\t\t\tlinkDirectionalParticles,\n\t\t\tlinkDirectionalParticleSpeed,\n\t\t\tlabelSize,\n\t\t\tchargeStrength,\n\t\t\tdistanceMax,\n\t\t\tforceEngine,\n\t\t\tnumDimensions,\n\t\t\tdagMode,\n\t\t\tdagLevelDistance,\n\t\t\twarmupTicks,\n\t\t\tcooldownTicks,\n\t\t\treset,\n\t\t};\n\t},\n\t{\n\t\tpersist: true,\n\t},\n);"
    },
    {
      "filename": "src/stores/graphStore.ts",
      "content": "import { defineStore } from 'pinia';\nimport { ref, computed, markRaw } from 'vue';\nimport * as jsonpatch from 'fast-json-patch';\nimport type { GraphState, GraphNode, GraphLink, AiStatus, GraphSettings } from '../types/graph';\n\nexport const useGraphStore = defineStore('graph', () => {\n  const state = ref<GraphState>({\n    nodes: {},\n    links: [],\n    focusNodeId: null,\n    thinkingNodeId: null,\n    settings: {\n      creativity: 0.7,\n      maxWords: 50,\n      minConnections: 2,\n      autoExplore: false,\n      definedAspects: [],\n      activeAspects: []\n    }\n  });\n\n  const isConnected = ref(false);\n  const isStateLoaded = ref(false);\n  const aiStatus = ref<AiStatus>('unloaded');\n  const serverAiConfig = ref({ selectedSize: 'medium', loadOnStartup: true });\n  const ws = ref<WebSocket | null>(null);\n\n  // Computed arrays\n  const nodesArray = computed(() => Object.values(state.value.nodes));\n  const linksArray = computed(() => state.value.links);\n\n  // Island calculation - Moved here and optimized to only trigger on link/node count changes\n  const graphIslands = computed(() => {\n    const nodes = nodesArray.value;\n    const links = linksArray.value;\n    if (nodes.length === 0) return [];\n\n    const adj = new Map<string, string[]>();\n    nodes.forEach(n => adj.set(n.id, []));\n    links.forEach(l => {\n      const s = typeof l.source === 'string' ? l.source : (l.source as any).id;\n      const t = typeof l.target === 'string' ? l.target : (l.target as any).id;\n      if (adj.has(s) && adj.has(t)) {\n        adj.get(s)?.push(t);\n        adj.get(t)?.push(s);\n      }\n    });\n\n    const visited = new Set<string>();\n    const islands: GraphNode[] = [];\n\n    nodes.forEach(node => {\n      if (!visited.has(node.id)) {\n        const component: GraphNode[] = [];\n        const queue = [node.id];\n        visited.add(node.id);\n        while (queue.length > 0) {\n          const currId = queue.shift()!;\n          const n = state.value.nodes[currId];\n          if (n) component.push(n);\n          (adj.get(currId) || []).forEach(nextId => {\n            if (!visited.has(nextId)) {\n              visited.add(nextId); queue.push(nextId);\n            }\n          });\n        }\n        component.sort((a, b) => (b.type === 'root' ? 1 : 0) - (a.type === 'root' ? 1 : 0));\n        islands.push(component[0]);\n      }\n    });\n    return islands;\n  });\n\n  function connect() {\n    if (ws.value) return;\n    const host = window.location.hostname || 'localhost';\n    ws.value = new WebSocket(`ws://${host}:3001`);\n\n    ws.value.onopen = () => { isConnected.value = true; };\n    ws.value.onclose = () => {\n      isConnected.value = false;\n      isStateLoaded.value = false;\n      ws.value = null;\n      setTimeout(connect, 3000);\n    };\n\n    ws.value.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === 'FULL_STATE') {\n        state.value = data.state;\n        isStateLoaded.value = true;\n      } else if (data.type === 'PATCH') {\n        // Apply patches to the reactive state\n        jsonpatch.applyPatch(state.value, data.patches);\n      } else if (data.type === 'AI_STATUS') {\n        aiStatus.value = data.status === 'ready' ? (state.value.thinkingNodeId ? 'thinking' : 'ready') : data.status;\n      } else if (data.type === 'AI_CONFIG_UPDATED') {\n        serverAiConfig.value = data.config;\n      } else if (data.type === 'ASPECT_SUGGESTIONS') {\n        window.dispatchEvent(new CustomEvent('aspect-suggestions', { detail: data.suggestions }));\n      }\n    };\n  }\n\n  function send(payload: any) {\n    if (ws.value?.readyState === WebSocket.OPEN) {\n      ws.value.send(JSON.stringify(payload));\n    }\n  }\n\n  return {\n    state,\n    isConnected,\n    isStateLoaded,\n    aiStatus,\n    serverAiConfig,\n    nodesArray,\n    linksArray,\n    graphIslands,\n    connect,\n    send\n  };\n});"
    },
    {
      "filename": "src/style.css",
      "content": "@import \"tailwindcss\";\n\n:root {\n\tbackground-color: #19191d;\n\tcolor: #ffffff;\n}\n\nbody {\n\tmargin: 0;\n\tpadding: 0;\n\toverflow: hidden;\n\twidth: 100vw;\n\theight: 100vh;\n\tuser-select: none;\n}\n\nbutton {\n\tuser-select: none;\n\tcursor: pointer;\n}\n\n#app {\n\twidth: 100%;\n\theight: 100%;\n}\n"
    },
    {
      "filename": "src/types/graph.ts",
      "content": "import type { NodeObject } from \"3d-force-graph\";\n\nexport type NodeStatus = 'proposed' | 'accepted' | 'forbidden';\n\nexport interface GraphNode extends NodeObject {\n  id: string;\n  label: string;\n  status: NodeStatus;\n  type: 'concept' | 'root';\n  val: number;\n  aspects: Record<string, number>;\n  description?: string;\n  emoji?: string;\n  group?: number;\n  attempts: Record<string, number>;\n  metadata?: {\n    reason?: string;\n    timestamp: number;\n  };\n  isLocked?: boolean;\n}\n\nexport interface GraphLink {\n  source: string | GraphNode;\n  target: string | GraphNode;\n  type: 'ai' | 'user' | 'bridge';\n  relationType?: string;\n  id?: string;\n}\n\nexport interface GraphSettings {\n  name: string;\n  creativity: number;\n  maxWords: number;\n  minConnections: number;\n  autoExplore: boolean;\n  definedAspects: string[];\n  activeAspects: string[];\n}\n\nexport interface GraphState {\n  nodes: Record<string, GraphNode>;\n  links: GraphLink[];\n  focusNodeId: string | null;\n  thinkingNodeId: string | null;\n  settings: GraphSettings;\n}\n\nexport interface GraphData {\n  nodes: GraphNode[];\n  links: GraphLink[];\n  settings?: GraphSettings;\n}\n\nexport type AiStatus = 'unloaded' | 'loading' | 'ready' | 'thinking' | 'error';\n\nexport interface ServerPatch {\n  op: 'add' | 'remove' | 'replace' | 'move' | 'copy' | 'test';\n  path: string;\n  value?: any;\n}"
    }
  ]
}